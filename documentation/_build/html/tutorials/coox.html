

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CO oxidation on Pt(111) &mdash; MonteCoffee  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parallel simulations" href="parallel.html" />
    <link rel="prev" title="Adsorption and reaction of species A and B2" href="A_B2_reac.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MonteCoffee
          

          
            
            <img src="../_static/avatar.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">Code overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quick.html">Quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="A_ads.html">Adsorption of atomic species A on surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="B2_ads.html">Dissociative Adsorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="A_B2_reac.html">Adsorption and reaction of species A and B2</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CO oxidation on Pt(111)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#define-constants-and-parameters">Define constants and parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#define-sites-and-system">Define sites and system</a></li>
<li class="toctree-l3"><a class="reference internal" href="#define-reaction-energies-and-entropies">Define reaction energies and entropies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#define-events">Define events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#define-and-run-simulation">Define and run simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analyze-results">Analyze results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parallel.html">Parallel simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="sites.html">Special site-rules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Special features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../options.html">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">User interface (API)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature.html">Additional reading</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MonteCoffee</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>CO oxidation on Pt(111)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/coox.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="parallel.html" class="btn btn-neutral float-right" title="Parallel simulations" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="A_B2_reac.html" class="btn btn-neutral float-left" title="Adsorption and reaction of species A and B2" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="coox"></span><div class="section" id="co-oxidation-on-pt-111">
<span id="index-0"></span><h1>CO oxidation on Pt(111)<a class="headerlink" href="#co-oxidation-on-pt-111" title="Permalink to this headline">¶</a></h1>
<p>We present here the CO oxidation on Pt(111) which is published along with the oxidation on Pt nanoparticles in: <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acscatal.7b01194">M. Jørgensen and H. Grönbeck, ACS Catal., 7, 5054-5061 (2017)</a> .</p>
<p>For the CO oxidation the following five chemical reactions have to be considered:</p>
<div class="math notranslate nohighlight">
\[\begin{split}O_2 + 2^* &amp; \longleftrightarrow  2O^* \\
CO + * &amp; \longleftrightarrow  CO* \\
CO^* + O^* &amp; \longrightarrow  CO_2 \\
CO^* + * &amp; \longleftrightarrow  * + CO^* \\
O^* + * &amp; \longleftrightarrow  * + O^*\end{split}\]</div>
<p>which are dissociative adsorption of oxygen, adsorption of CO, reaction of adsorbed O and CO to CO<sub>2</sub> and CO and O diffusion. In the model it is assumed that the reaction to CO<sub>2</sub> is not reversible and the reaction product is directly desorbing.</p>
<p>In this example, species 0 denotes empty sites, 1 is CO and 2 refers to O. All energies were obtained using density functional theory and are given in the paper mentioned above.</p>
<div class="section" id="define-constants-and-parameters">
<h2>Define constants and parameters<a class="headerlink" href="#define-constants-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>Any global constants can be defined in <a class="reference external" href="../api/NeighborKMC.examples.surface.html#module-NeighborKMC.examples.Pt_111_COOx.user_constants">user_constants.py</a>. In this example this file stores physical constants but also the calculated vibrations of the various adsorbed species and of the CO<sub>2</sub> formation transition state and their physical properties.</p>
<p>Next, the simulation parameters must be set and stored in a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">800.</span>  <span class="c1"># Temperature (K)</span>
<span class="n">pCO</span> <span class="o">=</span> <span class="mf">2E3</span>  <span class="c1"># CO pressure (Pa)</span>
<span class="n">pO2</span> <span class="o">=</span> <span class="mf">1E3</span>  <span class="c1"># O2 pressure (Pa)</span>
<span class="n">tend</span> <span class="o">=</span> <span class="mf">1E-3</span>  <span class="c1"># End time of simulation (s)</span>
</pre></div>
</div>
<p>Here the Temperature is set to 800 K, and the pressure ratio of CO to O<sub>2</sub> to 2:1. The pressure is given in Pa. Also the end time is defined, but because we are interested mainly in steady-state properties, the simulation is run until steady-state is reached and usually stopped before the given end time reached.</p>
</div>
<div class="section" id="define-sites-and-system">
<h2>Define sites and system<a class="headerlink" href="#define-sites-and-system" title="Permalink to this headline">¶</a></h2>
<p>One site is defined for each surface atom using an <code class="xref py py-class docutils literal notranslate"><span class="pre">Ase.Atoms</span></code> object. We are using the <code class="xref py py-class docutils literal notranslate"><span class="pre">ase.build</span></code> class to construct our (111) surface. It consists of only one layer, because its only purpose is to simplify the site-connectivity set-up. Therefore, the used lattice-parameter is also not related to any results of density functional theory calculations or experiments.
Thus starting with an empty list of sites we construct a <span class="math notranslate nohighlight">\(10x10\)</span> surface consisting of 100 atoms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">fcc111</span>
<span class="kn">from</span> <span class="nn">user_sites</span> <span class="kn">import</span> <span class="n">Site</span>

<span class="n">sites</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">4.00</span>  <span class="c1"># Lattice Parameter (not related to DFT!)</span>
<span class="n">Ncutoff</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span>  <span class="c1"># Nearest neighbor cutoff</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">fcc111</span><span class="p">(</span><span class="s2">&quot;Pt&quot;</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;surface.traj&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We also have written out the prepared surface as <cite>.traj</cite> file to see if it looks as intended. As next step we have to add a site for each surface atom. Although we know that the oxygen preferably adsorbs on fcc sites and the CO on top sites, we assume here all sites to be equal (coarse-graining) but use the corresponding energies of the preferred sites.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a site for each surface-atom:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
    <span class="n">sites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Site</span><span class="p">(</span><span class="n">stype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="n">covered</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<p>Here, the block <code class="code docutils literal notranslate"><span class="pre">ind=i</span></code> stores the index of the atom in the <code class="xref py py-class docutils literal notranslate"><span class="pre">ASE.Atoms</span></code> object on the <code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_sites.Site</span></code> object, which can be later on used to write out <cite>.traj</cite>-files during the simulation.</p>
<p>Now the <code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_system.System</span></code> object can be defined from the collection of sites:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">user_system</span> <span class="kn">import</span> <span class="n">System</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">System</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="c1"># store ASE.Atoms as well</span>
           <span class="n">sites</span><span class="o">=</span><span class="n">sites</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition to the overall system, we also need to define neighbor lists. It is simplest to define this according to the nearest neighbor distances. Thus we call in the main definition file of our kMC simulation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">set_neighbors</span><span class="p">(</span><span class="n">Ncutoff</span><span class="p">,</span><span class="n">pbc</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>which sets the global neighbor list based on distances for our System. Because we are using a surface, periodic boundary conditions are desirable. The actual function is then defined in <code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_sites.Site</span></code> and looks as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Ncutoff</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="s2">&quot;Tried to set neighbor-distances in user_system.set_neighbors() with self.atom = None&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">):</span>  <span class="c1">#For all sites</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">sother</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">):</span> <span class="c1">#Check all the other sites</span>
            <span class="n">dcur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_distance</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ind</span><span class="p">,</span> <span class="n">sother</span><span class="o">.</span><span class="n">ind</span><span class="p">,</span> <span class="n">mic</span><span class="o">=</span><span class="n">pbc</span><span class="p">)</span> <span class="c1"># use ase function get_distance</span>
            <span class="k">if</span> <span class="n">dcur</span> <span class="o">&lt;</span> <span class="n">Ncutoff</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">neighbors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>        <span class="c1">#add site j to neighbor list of site i</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>             <span class="c1">#check if neighbors exists -- otherwise the site will not interact with each other</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">neighbors</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_nlist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="define-reaction-energies-and-entropies">
<h2>Define reaction energies and entropies<a class="headerlink" href="#define-reaction-energies-and-entropies" title="Permalink to this headline">¶</a></h2>
<p>In this step, the reaction energies, or methods to calculate these, are defined in <a class="reference external" href="../api/NeighborKMC.examples.surface.html#module-NeighborKMC.examples.Pt_111_COOx.user_energy">user_energy.py</a> and the entropies in <a class="reference external" href="../api/NeighborKMC.examples.surface.html#module-NeighborKMC.examples.Pt_111_COOx.user_entropy">user_entropy.py</a>. That makes it simple to do all the book-keeping accordingly.</p>
<p>We used the from density functional theory obtained energies for the adsorption of oxygen on the fcc site and of CO on the top site and diffusion constants for oxygen to diffuse from fcc to fcc site and for CO for from top to top site.
In this example, the adsorption energies are defined to be positiv in contradiction to the more generally used negative notation in theoretical papers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">EadsCO</span> <span class="o">=</span> <span class="mf">1.36</span>
<span class="n">EadsO</span> <span class="o">=</span> <span class="mf">0.97</span>

<span class="n">EdiffCO</span> <span class="o">=</span> <span class="mf">0.08</span> <span class="c1"># CO diffusion barrier</span>
<span class="n">EdiffO</span> <span class="o">=</span> <span class="mf">0.58</span> <span class="c1"># O diffusion barrier</span>
</pre></div>
</div>
<p>From the adsorption energies the activation energy for the CO<sub>2</sub> formation is calculated from the BEP relations according to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_Ea</span><span class="p">(</span><span class="n">ECO</span><span class="p">,</span> <span class="n">EO</span><span class="p">):</span>
    <span class="n">ETS</span> <span class="o">=</span> <span class="mf">0.824</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EO</span> <span class="o">-</span><span class="n">ECO</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.168</span> <span class="o">+</span> <span class="mf">0.47238</span>  <span class="c1"># How much larger is the energy of CO and O wrt Pt(111)</span>
    <span class="n">Ea</span> <span class="o">=</span> <span class="n">ETS</span> <span class="o">+</span> <span class="n">ECO</span> <span class="o">+</span> <span class="n">EO</span>  <span class="c1"># Translate the barriers relative to Pt(111)</span>
    <span class="k">return</span> <span class="n">Ea</span>
</pre></div>
</div>
<p>The reason why not one single activation energy is used, are the repulsive adsorbate-adsorbate interactions which depend locally on the coverage of the neighbors of the reaction site:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_repulsion</span><span class="p">(</span><span class="n">cov_self</span><span class="p">,</span> <span class="n">cov_NN</span><span class="p">,</span> <span class="n">stype</span><span class="p">):</span>
    <span class="n">repulsion</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">ECOCO</span> <span class="o">=</span> <span class="mf">0.19</span>  <span class="c1">#  How CO affects CO</span>
    <span class="n">EOO</span> <span class="o">=</span> <span class="mf">0.32</span>  <span class="c1"># How O affects O</span>
    <span class="n">ECOO</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># How CO affects O</span>
    <span class="n">EOCO</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># How O affects CO</span>
    <span class="n">HInttwo</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ECOCO</span><span class="p">,</span> <span class="n">EOCO</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ECOO</span><span class="p">,</span> <span class="n">EOO</span><span class="p">]]</span>  <span class="c1"># Two body interaction Hamiltonian 3x3 because 0 = empty.</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">cov_NN</span><span class="p">:</span>  <span class="c1"># For each covered Neighbor, give a repulsion:</span>
        <span class="n">repulsion</span> <span class="o">+=</span> <span class="n">HInttwo</span><span class="p">[</span><span class="n">cov_self</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">repulsion</span>
</pre></div>
</div>
<p>The in <a class="reference external" href="../api/NeighborKMC.examples.surface.html#module-NeighborKMC.examples.Pt_111_COOx.user_entropy">user_entropy.py</a> stored entropies are included in the calculation of the rates as will be shown in the next section. Generally we define here the entropy for gas-phase CO and oxygen, as well as a method to calculate harmonic adsorbate entropy. The definitions of this functions can be looked up in this file directly.</p>
</div>
<div class="section" id="define-events">
<span id="defeventsquick"></span><h2>Define events<a class="headerlink" href="#define-events" title="Permalink to this headline">¶</a></h2>
<p>Here event-types are defined, which are stored in <a class="reference external" href="../api/NeighborKMC.examples.surface.html#module-NeighborKMC.examples.Pt_111_COOx.user_events">user_events.py</a>.
For each possible type of event, a class is derived from <a class="reference internal" href="../api/NeighborKMC.base.html#NeighborKMC.base.events.EventBase" title="NeighborKMC.base.events.EventBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.base.events.EventBase</span></code></a>.
For example take the <span class="math notranslate nohighlight">\(\mathrm{CO_2}\)</span> formation. This event is defined in <a class="reference external" href="../api/NeighborKMC.examples.surface.html#module-NeighborKMC.examples.Pt_111_COOx.user_events">user_events.py</a> as follows.</p>
<p>First we import the necessary functions, classes, and constants:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">base.events</span> <span class="kn">import</span> <span class="n">EventBase</span>
<span class="kn">from</span> <span class="nn">user_entropy</span> <span class="kn">import</span> <span class="n">get_Zvib</span><span class="p">,</span> <span class="n">get_Z_CO</span><span class="p">,</span> <span class="n">get_Z_O2</span>
<span class="kn">from</span> <span class="nn">user_constants</span> <span class="kn">import</span> <span class="n">mCO</span><span class="p">,</span> <span class="n">mO2</span><span class="p">,</span> <span class="n">Asite</span><span class="p">,</span> <span class="n">modes_COads</span><span class="p">,</span> <span class="n">modes_Oads</span><span class="p">,</span>\
        <span class="n">modes_TS_COOx</span><span class="p">,</span> <span class="n">modes_COgas</span><span class="p">,</span> <span class="n">modes_O2gas</span><span class="p">,</span> <span class="n">kB</span><span class="p">,</span> <span class="n">eV2J</span><span class="p">,</span> <span class="n">s0CO</span><span class="p">,</span> <span class="n">s0O</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span>
<span class="kn">from</span> <span class="nn">user_energy</span> <span class="kn">import</span> <span class="n">EadsCO</span><span class="p">,</span> <span class="n">EadsO</span><span class="p">,</span> <span class="n">get_Ea</span><span class="p">,</span> <span class="n">get_repulsion</span><span class="p">,</span> <span class="n">EdiffCO</span><span class="p">,</span> <span class="n">EdiffO</span>
</pre></div>
</div>
<p>Now we derive a class to contain the event:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">COOxEvent</span><span class="p">(</span><span class="n">EventBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">Zads</span> <span class="o">=</span> <span class="n">get_Zvib</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span> <span class="n">modes_COads</span><span class="p">)</span> <span class="o">*</span> <span class="n">get_Zvib</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span> <span class="n">modes_Oads</span><span class="p">)</span>
        <span class="n">Zts</span> <span class="o">=</span> <span class="n">get_Zvib</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span> <span class="n">modes_TS_COOx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Zratio</span> <span class="o">=</span> <span class="n">Zts</span> <span class="o">/</span> <span class="n">Zads</span>
        <span class="n">EventBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>The constructor <code class="code docutils literal notranslate"><span class="pre">__init__(self,params)</span></code>  attaches relevant parameters to the object, and <code class="code docutils literal notranslate"><span class="pre">self.Zratio</span></code> is the ratio
between the partition functions in the initial state and transition state, used to calculate the rate constant in transition state theory. We need a function <cite>possible(self,system, site, other_site)</cite>
that returns True if the event is possible on the current site-pair:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">possible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> \
          <span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Thus, for the event to be possible, the site needs to be covered by 1 (CO) and the neighbor site by 2 (O) or the other way round. That is originated by the use of single neighbor site pairs. Thus a pair with the indexes (10,11) would be the same as (11,10) in the code to avoid double counting in the time list.</p>
<p>Next we need to define a function <code class="code docutils literal notranslate"><span class="pre">get_rate(self,</span> <span class="pre">system,</span> <span class="pre">i_site,</span> <span class="pre">other_site)</span></code> that returns the rate constant:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">i_site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="n">ECO</span> <span class="o">=</span> <span class="n">EadsCO</span>
    <span class="n">EO</span> <span class="o">=</span> <span class="n">EadsO</span>
    <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">Ncovs_CO</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="n">site</span><span class="p">]</span> <span class="p">]</span>
        <span class="n">Ncovs_O</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="n">other_site</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ncovs_CO</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span> <span class="p">]</span>
        <span class="n">Ncovs_O</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="n">site</span><span class="p">]]</span>
    <span class="n">ECO</span> <span class="o">-=</span> <span class="n">get_repulsion</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ncovs_CO</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">EO</span> <span class="o">-=</span> <span class="n">get_repulsion</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ncovs_O</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">Ea</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">get_Ea</span><span class="p">(</span><span class="n">ECO</span><span class="p">,</span> <span class="n">EO</span><span class="p">))</span> <span class="c1"># No negative energy barriers</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zratio</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ea</span><span class="o">/</span><span class="p">(</span><span class="n">kB</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="n">kB</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span>
</pre></div>
</div>
<p>The adsorption energies are fixed, but weaken in the case of any repulsions.
A call is made to <code class="code docutils literal notranslate"><span class="pre">get_Ea(ECO,</span> <span class="pre">EO)</span></code> to obtain the reaction energy barrier.
The rate constant is multiplied with <code class="code docutils literal notranslate"><span class="pre">self.alpha</span></code>, because <code class="code docutils literal notranslate"><span class="pre">self.alpha</span></code> is the slowing-down factor that is adjusted dynamically for each event during simulation.</p>
<p>Also the event requires a method <code class="code docutils literal notranslate"><span class="pre">do_event(self,system,</span> <span class="pre">site,</span> <span class="pre">other_site)</span></code> to perform modifications to the site-occupations when fired:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>In this case, the two sites containing CO and O are simply emptied. At the end we define the method <code class="code docutils literal notranslate"><span class="pre">get_involve_other(self)</span></code> to define if the neighboring sites are actually involved in the event:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_involve_other</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p>After giving this example for one event, the other events can be defined similarly. How to define single site and dissociative adsorption was shown before. Only the rates have to be adjusted according to transition state theory. Having all events for each type of reaction defined in this order:</p>
<blockquote>
<div><ul class="simple">
<li><ol class="arabic simple" start="0">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_events.COAdsEvent</span></code> for CO adsorption.</p></li>
</ol>
</li>
<li><ol class="arabic simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_events.CODesEvent</span></code> for CO desorption.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_events.OAdsEvent</span></code> for O2 dissociative adsorption.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_events.ODesEvent</span></code> for O2 desorption.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="4">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_events.CODiffEvent</span></code> for CO diffusion.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="5">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_events.ODiffEvent</span></code> for O diffusion.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="6">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_events.COOxEvent</span></code> for CO+O -&gt; CO2.</p></li>
</ol>
</li>
</ul>
</div></blockquote>
<p>we can now store the event-class references in a list for the NeighborKMC simulations and define accordingly a list of reverse events. In this example the CO (O) adsorption and desorption are reverse to each other. In addition are the diffusion processes reverse to themselves. The CO oxidation itself is not reversible. Thus it isn’t defined in this list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="n">COAdsEvent</span><span class="p">,</span> <span class="n">CODesEvent</span><span class="p">,</span> <span class="n">OAdsEvent</span><span class="p">,</span>
          <span class="n">ODesEvent</span><span class="p">,</span> <span class="n">CODiffEvent</span><span class="p">,</span>
          <span class="n">ODiffEvent</span><span class="p">,</span> <span class="n">COOxEvent</span><span class="p">]</span>
<span class="n">reverse_events</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</pre></div>
</div>
<p>The numbering of events is determined by the order in the list <code class="code docutils literal notranslate"><span class="pre">events</span></code> defined here.</p>
</div>
<div class="section" id="define-and-run-simulation">
<h2>Define and run simulation<a class="headerlink" href="#define-and-run-simulation" title="Permalink to this headline">¶</a></h2>
<p>Now the simulation object <code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.user_kmc.NeighborKMC</span></code> can be defined and the simulation performed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate simulator object.</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">NeighborKMC</span><span class="p">(</span><span class="n">system</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">tend</span><span class="o">=</span><span class="n">tend</span><span class="p">,</span>
                  <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                  <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span>
                  <span class="n">rev_events</span><span class="o">=</span><span class="n">reverse_events</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run_kmc</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation end time reached ! ! !&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="analyze-results">
<span id="analyzecoox"></span><h2>Analyze results<a class="headerlink" href="#analyze-results" title="Permalink to this headline">¶</a></h2>
<p>The results are analyzed by reading in the <a class="reference internal" href="../overview/output.html#output"><span class="std std-ref">code output</span></a>. For example, if we need to calculate the CO and O coverage as a function of time for the entire system:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;time.txt&quot;</span><span class="p">)</span>
<span class="n">covs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;coverages.txt&quot;</span><span class="p">)</span>
<span class="n">Nsites</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">covs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">cov_CO</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">covs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">Nsites</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">covs</span><span class="p">))]</span>
<span class="n">cov_O</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">covs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">Nsites</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">covs</span><span class="p">))]</span>
<span class="n">cov_free</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">covs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">Nsites</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">covs</span><span class="p">))]</span>
</pre></div>
</div>
<p>Typically, a turnover frequency is also relevant to calculate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">evs_exec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;evs_exec.txt&quot;</span><span class="p">)</span>
<span class="n">TOF</span> <span class="o">=</span> <span class="n">evs_exec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">Nsites</span><span class="o">*</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># How many CO+O-&gt;CO2 has fired per time and site.</span>
</pre></div>
</div>
<p>Often it can be useful to discard points out of steady-state. The detailed evolution of the time with the sites can be found in <cite>detail_site_event_evol.hdf5</cite>.
To draw statistically sound conclusions, it is recommended that multiple identically prepared simulations are performed and in this case at least 100 CO oxidation events are performed in the steady state.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parallel.html" class="btn btn-neutral float-right" title="Parallel simulations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="A_B2_reac.html" class="btn btn-neutral float-left" title="Adsorption and reaction of species A and B2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Division of Chemical Physics, Chalmers University of Technology

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>