

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Adsorption and reaction of species A and B2 &mdash; MonteCoffee  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parallel simulations" href="parallel.html" />
    <link rel="prev" title="Dissociative Adsorption" href="B2_ads.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MonteCoffee
          

          
            
            <img src="../_static/avatar.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Code overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Code output</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="A_ads.html">Adsorption of atomic species A on surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="B2_ads.html">Dissociative Adsorption</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Adsorption and reaction of species A and B2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#define-events">Define events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reaction-over-a-100-surface">Reaction over a (100) surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reaction-over-a-nanoparticle">Reaction over a nanoparticle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parallel.html">Parallel simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="sites.html">Special site-rules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../options.html">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">User interface (API)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature.html">Additional reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MonteCoffee</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>Adsorption and reaction of species A and B2</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/A_B2_reac.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="parallel.html" class="btn btn-neutral float-right" title="Parallel simulations" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="B2_ads.html" class="btn btn-neutral float-left" title="Dissociative Adsorption" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adsorption-and-reaction-of-species-a-and-b2">
<span id="a-b2-reac"></span><h1>Adsorption and reaction of species A and B2<a class="headerlink" href="#adsorption-and-reaction-of-species-a-and-b2" title="Permalink to this headline">¶</a></h1>
<p>Turning from simple adsorption events towards surface reactions, we demonstrate here the <span class="math notranslate nohighlight">\(A+B_2\)</span> reaction
on a fcc(100) surface and a truncated octahedral nanoparticle. The reaction is modeled using the following reactions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A(g) + ^* \longleftrightarrow A^*      \\
A^* + ^* \longleftrightarrow * + A^*    \\
B_2(g) + 2^* \longleftrightarrow 2B^*  \\
B^* + ^* \longleftrightarrow ^*+B^*      \\
A^*+B^* \longrightarrow AB(g) + 2^*\end{split}\]</div>
<p>Thus additional to the already described events of atomar and dissociative adsorption, the diffusion of species <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span>, as well as the formation and desorption of <span class="math notranslate nohighlight">\(AB\)</span> has to be implemented. In the following we present first
the event classes which are additionally needed and are the same for the nanoparticle and the surface.</p>
<div class="section" id="define-events">
<h2>Define events<a class="headerlink" href="#define-events" title="Permalink to this headline">¶</a></h2>
<p>The defined events are stored in <a class="reference external" href="../api/NeighborKMC.tutorials.A_B2_reaction.surface_100.html#module-NeighborKMC.tutorials.A_B2_reaction.surface_100.user_events">user_events.py</a>.
For each possible type of event, a class is derived from <a class="reference internal" href="../api/NeighborKMC.base.html#NeighborKMC.base.events.EventBase" title="NeighborKMC.base.events.EventBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborKMC.base.events.EventBase</span></code></a>. In this
case, we need to define seven different events, the adsorption, desorption and diffusion of species A and B<sub>2</sub>, and
the reaction between both species. The adsorption and diffusion of A and B<sub>2</sub> are defined as before. For the A diffusion
we derive a class to contain the event:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ADiffEvent</span><span class="p">(</span><span class="n">EventBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">EventBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>The constructor <code class="code docutils literal notranslate"><span class="pre">__init__(self,params)</span></code> attaches relevant parameters to the object.
We need a function <cite>possible(self,system, site, other_site)</cite> that returns True if the event is possible on the current site-pair.
Here we assume that the species A is assigned to the coverage number:2. A diffusion event can take place if the site is covered
with A and the neighbor site empty or wise versa.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">possible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="c1"># If site is uncovered</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Now we also need to define a function <code class="code docutils literal notranslate"><span class="pre">get_rate(self,</span> <span class="pre">system,</span> <span class="pre">i_site,</span> <span class="pre">other_site)</span></code> that returns the rate constant. To keep this as simple as possible, the rate constant is chosen to be <span class="math notranslate nohighlight">\(R=1\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">i_site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">return</span> <span class="n">R</span>
</pre></div>
</div>
<p>Each event requires a method <code class="code docutils literal notranslate"><span class="pre">do_event(self,system,</span> <span class="pre">site,</span> <span class="pre">other_site)</span></code> to perform modifications to the site-occupations when fired:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="n">old_cov_site</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span>
    <span class="n">old_cov_other_site</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span>
    <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">=</span> <span class="n">old_cov_other_site</span>
    <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">=</span> <span class="n">old_cov_site</span>
</pre></div>
</div>
<p>In this case, the coverage of the <code class="code docutils literal notranslate"><span class="pre">site</span></code> and <code class="code docutils literal notranslate"><span class="pre">other_site</span></code> are interchanged.</p>
<p>To take care of the correct time evolution of the <strong class="program">MonteCoffee</strong> we introduce an additional block which returns if either neighboring sites are involved or not. Here no neighboring sites are involved, thus we <code class="code docutils literal notranslate"><span class="pre">return</span> <span class="pre">False</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_involve_other</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p>The diffusion of species B is exactly as for species A implemented, with the difference that B is represented by 1 in the code.</p>
<p>For the reaction, A and B have to be present on either <code class="code docutils literal notranslate"><span class="pre">site</span></code> or <code class="code docutils literal notranslate"><span class="pre">other_site</span></code>. So the reaction becomes possible if:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">possible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
         <span class="k">return</span> <span class="kc">True</span>
     <span class="k">else</span><span class="p">:</span>
         <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>The rate constant can be chosen according to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
     <span class="n">R</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
     <span class="k">return</span> <span class="n">R</span>
</pre></div>
</div>
<p>and after the formation of AB, both sites: code:<cite>site</cite> and code:<cite>other_site</cite> are emptied:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">other_site</span><span class="p">]</span><span class="o">.</span><span class="n">covered</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>In this shown example, it is assumed that the desorption of the formed product AB is instantaneous without the possibility to re-absorb and split into A and B.</p>
</div>
<div class="section" id="reaction-over-a-100-surface">
<h2>Reaction over a (100) surface<a class="headerlink" href="#reaction-over-a-100-surface" title="Permalink to this headline">¶</a></h2>
<p>For the reaction over a (100) surface we use <strong class="program">ASE</strong> to define the sites and their neighbors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">fcc</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">user_sites</span> <span class="kn">import</span> <span class="n">Site</span>

<span class="n">surface</span> <span class="o">=</span> <span class="n">fcc100</span><span class="p">(</span><span class="s2">&quot;Pt&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">latt_param</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sites</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Create a site for each surface-atom:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
    <span class="n">sites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Site</span><span class="p">(</span><span class="n">stype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="n">covered</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<p>A 20x20 lattice is used to ensure convergence of the coverage and each atom site is connected to its four neighbors.
The in <a class="reference internal" href="#figab2-surf"><span class="std std-numref">Fig. 1</span></a> shown coverage is based on the following rate constants: Adsorption, desorption and
diffusion rate: 1 s<sup>-1</sup> and the reaction rate: 0.1  s<sup>-1</sup>. It should be noted the mean-field
rate of 1 s<sup>-1</sup> for B<sub>2</sub> adsorption/desorption corresponds to 0.5 s<sup>-1</sup> in the kMC model.
With the reaction being the rate limiting step, all coverages are 1/3 after an equilibration period as can be seen
in <a class="reference internal" href="#figab2-surf"><span class="std std-numref">Fig. 1</span></a>.</p>
<div class="figure align-default" id="id1">
<span id="figab2-surf"></span><a class="reference internal image-reference" href="../_images/AB2_surf_cov.pdf"><img alt="../_images/AB2_surf_cov.pdf" src="../_images/AB2_surf_cov.pdf" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Time evolution of the coverage of species A and B on a 20x20 (100) surface.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="reaction-over-a-nanoparticle">
<h2>Reaction over a nanoparticle<a class="headerlink" href="#reaction-over-a-nanoparticle" title="Permalink to this headline">¶</a></h2>
<p>Similar to the (100) surface, we employ again <strong class="program">ASE</strong> to define the sites, this time
constructing a truncated octahedron consisting of 260 atoms of which 144 are exposed on the surface. In contrast
to the surface, we
are going to use two different type of sites, <code class="code docutils literal notranslate"><span class="pre">stype=0</span></code> representing the (111) facet sites
and <code class="code docutils literal notranslate"><span class="pre">stype=1</span></code> representing the (100) facet sites, edges and corners. In the inset of <a class="reference internal" href="#figab2-nano"><span class="std std-numref">Fig. 2</span></a> the
different types of sites are visualized.</p>
<p>The atoms are defined as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="n">Octahedron</span><span class="p">(</span><span class="s2">&quot;Pt&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">latticeconstant</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span>
<span class="n">sites</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">write</span><span class="p">(</span><span class="s1">&#39;trunc_octa.traj&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">)</span> <span class="c1"># see how the nanoparticle looks like</span>
</pre></div>
</div>
<p>but to assign the site types to the surface atoms, we use the coordination number to distinguish them,
the (111) facet sites having a coordination number of 9. So coordination number of each atom
is calculated and a list, <code class="code docutils literal notranslate"><span class="pre">surface_atom_ids</span></code> created in which the surface atom ids
(coordination number &lt; 12) are stored.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">CNS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))</span>
 <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
     <span class="n">pcur</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">position</span>
     <span class="n">dp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">pcur</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2.</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pcur</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2.</span> <span class="o">+</span>
                    <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">pcur</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2.</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">])</span>
     <span class="n">CNS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dp</span> <span class="k">if</span> <span class="mf">0.</span> <span class="o">&lt;</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">])</span>
<span class="n">surface_atom_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CNS</span><span class="p">))</span> <span class="k">if</span> <span class="n">CNS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
<p>In different to the surface, each site has now stype assigned which is either 0 or 1. For the surface all
sites had the same stype.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">indic</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">surface_atom_ids</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">CNS</span><span class="p">[</span><span class="n">indic</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
        <span class="n">sstype</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sstype</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">sites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Site</span><span class="p">(</span><span class="n">stype</span><span class="o">=</span><span class="n">sstype</span><span class="p">,</span> <span class="n">covered</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">indic</span><span class="p">))</span>
</pre></div>
</div>
<p>The neighbor list is calculated for the surface atom shell only (the atoms saved in the sites-list).
Now not all atoms have the same number of direct neighbors, but according to their coordination number.</p>
<p>In the following we keep all rates fixed to the surface ones, beside the rates for the A adsorption.
For the A adsorption we are going to employ different, site-dependent adsorption rates. Therefore, beside
ensuring that the side is empty, also the stype has to be considered to determine the adsorption rate.
That is done in the following way in the <code class="xref py py-class docutils literal notranslate"><span class="pre">AAdsEvent</span></code> :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">other_site</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">stype</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
       <span class="n">R</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">elif</span> <span class="n">system</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">stype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
       <span class="n">R</span> <span class="o">=</span> <span class="mf">10.</span>
    <span class="k">return</span>  <span class="n">R</span>
</pre></div>
</div>
<p>To see the effect of the rate of the A adsorption on the turn over frequency (TOF) of the
simulation, we study the four different possible combinations: First using either a rate constant
of 1 s<sup>-1</sup> or 10 s<sup>-1</sup> on both sites and second by using the mixed cases, having  1  s<sup>-1</sup>
for <code class="code docutils literal notranslate"><span class="pre">stype=0</span></code> and  10 s<sup>-1</sup> for <code class="code docutils literal notranslate"><span class="pre">stype=1</span></code> or wise versa. The results can be seen
in <a class="reference internal" href="#figab2-nano"><span class="std std-numref">Fig. 2</span></a>. In the case of employing the same rate for the A adsorption as for the B adsorption
the TOF is the highest, and with having a 10 times faster A adsorption than B adsorption, it being the lowest.
In the case of high A adsorption, the sites are blocked leading to poisoning. For the mixed cases,
the TOF is higher for the one with rate <code class="code docutils literal notranslate"><span class="pre">stype=0</span></code>: 10 s<sup>-1</sup>. Not as many sites with <code class="code docutils literal notranslate"><span class="pre">stype=0</span></code> exist
and therefore the A poisoning is less pronounce.</p>
<div class="figure align-default" id="id2">
<span id="figab2-nano"></span><a class="reference internal image-reference" href="../_images/AB2_nano_tof.pdf"><img alt="../_images/AB2_nano_tof.pdf" src="../_images/AB2_nano_tof.pdf" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Turn over frequency for different choices of A adsorption rates. The first number refers to the rate
in s<sup>-1</sup> of the site with <code class="code docutils literal notranslate"><span class="pre">stype=0</span></code> and the second number to the rate of <code class="code docutils literal notranslate"><span class="pre">stype=1</span></code>.
The inset shows the different type of sites on a truncated octahedron with orange being: <code class="code docutils literal notranslate"><span class="pre">stype=0</span></code>
and blue <code class="code docutils literal notranslate"><span class="pre">stype=1</span></code>.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parallel.html" class="btn btn-neutral float-right" title="Parallel simulations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="B2_ads.html" class="btn btn-neutral float-left" title="Dissociative Adsorption" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Division of Chemical Physics, Chalmers University of Technology

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>